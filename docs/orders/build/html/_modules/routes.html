<!DOCTYPE html>

<html lang="en" data-content_root="../">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>routes &#8212; Orders Service 1.0 documentation</title>
    <link rel="stylesheet" type="text/css" href="../_static/pygments.css?v=d1102ebc" />
    <link rel="stylesheet" type="text/css" href="../_static/alabaster.css?v=12dfc556" />
    <script src="../_static/documentation_options.js?v=f2a433a1"></script>
    <script src="../_static/doctools.js?v=9a2dae69"></script>
    <script src="../_static/sphinx_highlight.js?v=dc90522c"></script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
   
  <link rel="stylesheet" href="../_static/custom.css" type="text/css" />
  

  
  

  </head><body>
  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          

          <div class="body" role="main">
            
  <h1>Source code for routes</h1><div class="highlight"><pre>
<span></span><span class="kn">from</span> <span class="nn">botocore.exceptions</span> <span class="kn">import</span> <span class="n">ClientError</span>
<span class="kn">from</span> <span class="nn">flask</span> <span class="kn">import</span> <span class="n">Blueprint</span><span class="p">,</span> <span class="n">jsonify</span><span class="p">,</span> <span class="n">request</span>

<span class="kn">import</span> <span class="nn">dynamodb_po</span><span class="o">,</span> <span class="nn">dynamodb_users</span><span class="o">,</span> <span class="nn">invoice</span><span class="o">,</span> <span class="nn">utils</span>

<span class="n">route_blueprint</span> <span class="o">=</span> <span class="n">Blueprint</span><span class="p">(</span>
    <span class="s2">&quot;&quot;</span><span class="p">,</span>
    <span class="vm">__name__</span><span class="p">,</span>
<span class="p">)</span>


<div class="viewcode-block" id="test">
<a class="viewcode-back" href="../routes.html#routes.test">[docs]</a>
<span class="nd">@route_blueprint</span><span class="o">.</span><span class="n">route</span><span class="p">(</span><span class="s2">&quot;/&quot;</span><span class="p">,</span> <span class="n">methods</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;GET&quot;</span><span class="p">])</span>
<span class="k">def</span> <span class="nf">test</span><span class="p">():</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Test API to check endpoint works properly</span>

<span class="sd">    Returns:</span>
<span class="sd">        json: success message if endpoint is working, error otherwise</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">try</span><span class="p">:</span>
        <span class="c1"># Return success response</span>
        <span class="k">return</span> <span class="n">jsonify</span><span class="p">({</span><span class="s2">&quot;status&quot;</span><span class="p">:</span> <span class="kc">True</span><span class="p">,</span> <span class="s2">&quot;message&quot;</span><span class="p">:</span> <span class="s2">&quot;Test successful&quot;</span><span class="p">}),</span> <span class="mi">201</span>
    <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
        <span class="c1"># Handle the exception</span>
        <span class="n">error_message</span> <span class="o">=</span> <span class="s2">&quot;An error occurred: &quot;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">e</span><span class="p">)</span>
        <span class="c1"># Return error response</span>
        <span class="k">return</span> <span class="n">jsonify</span><span class="p">({</span><span class="s2">&quot;status&quot;</span><span class="p">:</span> <span class="kc">False</span><span class="p">,</span> <span class="s2">&quot;message&quot;</span><span class="p">:</span> <span class="n">error_message</span><span class="p">}),</span> <span class="mi">500</span></div>



<div class="viewcode-block" id="get_order_req">
<a class="viewcode-back" href="../routes.html#routes.get_order_req">[docs]</a>
<span class="nd">@route_blueprint</span><span class="o">.</span><span class="n">route</span><span class="p">(</span><span class="s2">&quot;/orders/&lt;order_id&gt;&quot;</span><span class="p">,</span> <span class="n">methods</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;GET&quot;</span><span class="p">])</span>
<span class="k">def</span> <span class="nf">get_order_req</span><span class="p">(</span><span class="n">order_id</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Fetches user order by unique ID</span>

<span class="sd">    Args:</span>
<span class="sd">        order_id (string): Unique order ID</span>

<span class="sd">    Returns:</span>
<span class="sd">        json : JSON response containing the order details if found, or an error message if not.</span>

<span class="sd">    Raises</span>
<span class="sd">       ClientError: If there&#39;s a DynamoDB client error during account retrieval.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">try</span><span class="p">:</span>
        <span class="c1"># Check if the order_id parameter is provided</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">order_id</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">jsonify</span><span class="p">({</span><span class="s2">&quot;error&quot;</span><span class="p">:</span> <span class="s2">&quot;Order ID is missing&quot;</span><span class="p">,</span> <span class="s2">&quot;status&quot;</span><span class="p">:</span> <span class="kc">False</span><span class="p">}),</span> <span class="mi">400</span>

        <span class="c1"># Call the get_order function</span>
        <span class="n">res</span> <span class="o">=</span> <span class="n">dynamodb_users</span><span class="o">.</span><span class="n">get_order</span><span class="p">(</span><span class="n">order_id</span><span class="p">)</span>

        <span class="c1"># Return the response</span>
        <span class="k">return</span> <span class="n">jsonify</span><span class="p">({</span><span class="s2">&quot;status&quot;</span><span class="p">:</span> <span class="kc">True</span><span class="p">,</span> <span class="s2">&quot;value&quot;</span><span class="p">:</span> <span class="n">res</span><span class="p">}),</span> <span class="mi">200</span>
    <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
        <span class="c1"># If an exception occurs, return an error response</span>
        <span class="k">return</span> <span class="n">jsonify</span><span class="p">({</span><span class="s2">&quot;error&quot;</span><span class="p">:</span> <span class="nb">str</span><span class="p">(</span><span class="n">e</span><span class="p">),</span> <span class="s2">&quot;status&quot;</span><span class="p">:</span> <span class="kc">False</span><span class="p">}),</span> <span class="mi">500</span></div>



<div class="viewcode-block" id="get_all_orders_req">
<a class="viewcode-back" href="../routes.html#routes.get_all_orders_req">[docs]</a>
<span class="nd">@route_blueprint</span><span class="o">.</span><span class="n">route</span><span class="p">(</span><span class="s2">&quot;/orders&quot;</span><span class="p">,</span> <span class="n">methods</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;GET&quot;</span><span class="p">])</span>
<span class="k">def</span> <span class="nf">get_all_orders_req</span><span class="p">():</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Fetches user order from user order table, used mainly for debugging</span>

<span class="sd">    Returns:</span>
<span class="sd">        json : Array of JSON response containing the orders details</span>

<span class="sd">    Raises</span>
<span class="sd">       ClientError: If there&#39;s a DynamoDB client error during account retrieval.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">try</span><span class="p">:</span>
        <span class="c1"># Call the get_all_orders function</span>
        <span class="n">res</span> <span class="o">=</span> <span class="n">dynamodb_users</span><span class="o">.</span><span class="n">get_all_orders</span><span class="p">()</span>

        <span class="c1"># Return the response</span>
        <span class="k">return</span> <span class="n">jsonify</span><span class="p">({</span><span class="s2">&quot;status&quot;</span><span class="p">:</span> <span class="kc">True</span><span class="p">,</span> <span class="s2">&quot;value&quot;</span><span class="p">:</span> <span class="n">res</span><span class="p">}),</span> <span class="mi">200</span>
    <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
        <span class="c1"># If an exception occurs, return an error response</span>
        <span class="k">return</span> <span class="n">jsonify</span><span class="p">({</span><span class="s2">&quot;error&quot;</span><span class="p">:</span> <span class="nb">str</span><span class="p">(</span><span class="n">e</span><span class="p">),</span> <span class="s2">&quot;status&quot;</span><span class="p">:</span> <span class="kc">False</span><span class="p">}),</span> <span class="mi">500</span></div>



<div class="viewcode-block" id="delete_order_req">
<a class="viewcode-back" href="../routes.html#routes.delete_order_req">[docs]</a>
<span class="nd">@route_blueprint</span><span class="o">.</span><span class="n">route</span><span class="p">(</span><span class="s2">&quot;/orders/&lt;order_id&gt;&quot;</span><span class="p">,</span> <span class="n">methods</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;DELETE&quot;</span><span class="p">])</span>
<span class="k">def</span> <span class="nf">delete_order_req</span><span class="p">(</span><span class="n">order_id</span><span class="p">:</span> <span class="nb">int</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Delete order from user order table, using the passed unique order ID</span>

<span class="sd">    Args:</span>
<span class="sd">        order_id (string): Unique order ID</span>

<span class="sd">    Returns:</span>
<span class="sd">        json: JSON with status indicating if the order was successfully removed or nor, with the response from DynamoDB</span>

<span class="sd">    Raises</span>
<span class="sd">       ClientError: If there&#39;s a DynamoDB client error during account retrieval.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">try</span><span class="p">:</span>
        <span class="c1"># Check if the order_id parameter is provided</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">order_id</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">jsonify</span><span class="p">({</span><span class="s2">&quot;error&quot;</span><span class="p">:</span> <span class="s2">&quot;Order ID is missing&quot;</span><span class="p">,</span> <span class="s2">&quot;status&quot;</span><span class="p">:</span> <span class="kc">False</span><span class="p">}),</span> <span class="mi">400</span>

        <span class="c1"># Call the delete_order function</span>
        <span class="n">res</span> <span class="o">=</span> <span class="n">dynamodb_users</span><span class="o">.</span><span class="n">delete_order</span><span class="p">(</span><span class="n">order_id</span><span class="p">)</span>

        <span class="c1"># Return the response</span>
        <span class="k">return</span> <span class="n">jsonify</span><span class="p">({</span><span class="s2">&quot;status&quot;</span><span class="p">:</span> <span class="kc">True</span><span class="p">,</span> <span class="s2">&quot;value&quot;</span><span class="p">:</span> <span class="n">res</span><span class="p">}),</span> <span class="mi">200</span>
    <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
        <span class="c1"># If an exception occurs, return an error response</span>
        <span class="k">return</span> <span class="n">jsonify</span><span class="p">({</span><span class="s2">&quot;error&quot;</span><span class="p">:</span> <span class="nb">str</span><span class="p">(</span><span class="n">e</span><span class="p">),</span> <span class="s2">&quot;status&quot;</span><span class="p">:</span> <span class="kc">False</span><span class="p">}),</span> <span class="mi">500</span></div>



<div class="viewcode-block" id="update_order_req">
<a class="viewcode-back" href="../routes.html#routes.update_order_req">[docs]</a>
<span class="nd">@route_blueprint</span><span class="o">.</span><span class="n">route</span><span class="p">(</span><span class="s2">&quot;/orders/&lt;order_id&gt;&quot;</span><span class="p">,</span> <span class="n">methods</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;PUT&quot;</span><span class="p">])</span>
<span class="k">def</span> <span class="nf">update_order_req</span><span class="p">(</span><span class="n">order_id</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Updates order by adding/removing a certain product with a certain quantity</span>
<span class="sd">    body format eg.</span>

<span class="sd">    Args:</span>
<span class="sd">        order_id (string): Unique order ID</span>

<span class="sd">    Returns:</span>
<span class="sd">        json : JSON response containing the order details, with status true if successful operation, and false otherwise.</span>

<span class="sd">    Raises</span>
<span class="sd">       ClientError: If there&#39;s a DynamoDB client error during account retrieval.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">data</span> <span class="o">=</span> <span class="n">request</span><span class="o">.</span><span class="n">json</span>
    <span class="c1"># Check if all required parameters are present</span>
    <span class="n">required_params</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;product_id&quot;</span><span class="p">,</span> <span class="s2">&quot;quantity&quot;</span><span class="p">]</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="nb">all</span><span class="p">(</span><span class="n">param</span> <span class="ow">in</span> <span class="n">data</span> <span class="k">for</span> <span class="n">param</span> <span class="ow">in</span> <span class="n">required_params</span><span class="p">):</span>
        <span class="k">return</span> <span class="n">jsonify</span><span class="p">({</span><span class="s2">&quot;status&quot;</span><span class="p">:</span> <span class="kc">False</span><span class="p">,</span> <span class="s2">&quot;value&quot;</span><span class="p">:</span> <span class="s2">&quot;Missing required parameters&quot;</span><span class="p">}),</span> <span class="mi">400</span>

    <span class="k">try</span><span class="p">:</span>
        <span class="n">res</span> <span class="o">=</span> <span class="n">dynamodb_users</span><span class="o">.</span><span class="n">update_order</span><span class="p">(</span>
            <span class="n">order_id</span><span class="p">,</span> <span class="n">data</span><span class="p">[</span><span class="s2">&quot;product_id&quot;</span><span class="p">],</span> <span class="n">data</span><span class="p">[</span><span class="s2">&quot;quantity&quot;</span><span class="p">]</span>
        <span class="p">)</span>
        <span class="k">return</span> <span class="n">jsonify</span><span class="p">({</span><span class="s2">&quot;status&quot;</span><span class="p">:</span> <span class="kc">True</span><span class="p">,</span> <span class="s2">&quot;value&quot;</span><span class="p">:</span> <span class="n">res</span><span class="p">}),</span> <span class="mi">200</span>
    <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
        <span class="nb">print</span><span class="p">(</span><span class="n">e</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">jsonify</span><span class="p">({</span><span class="s2">&quot;status&quot;</span><span class="p">:</span> <span class="kc">False</span><span class="p">,</span> <span class="s2">&quot;value&quot;</span><span class="p">:</span> <span class="nb">str</span><span class="p">(</span><span class="n">e</span><span class="p">)}),</span> <span class="mi">500</span></div>



<div class="viewcode-block" id="search_orders">
<a class="viewcode-back" href="../routes.html#routes.search_orders">[docs]</a>
<span class="nd">@route_blueprint</span><span class="o">.</span><span class="n">route</span><span class="p">(</span><span class="s2">&quot;/orders/users/search/&lt;user_id&gt;&quot;</span><span class="p">,</span> <span class="n">methods</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;GET&quot;</span><span class="p">])</span>
<span class="k">def</span> <span class="nf">search_orders</span><span class="p">(</span><span class="n">user_id</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Searches user orders with the specified User ID</span>

<span class="sd">    Args:</span>
<span class="sd">        user_id (string): Unique user ID</span>

<span class="sd">    Returns:</span>
<span class="sd">        json : Array of JSON response containing orders details of orders that match the search criteria</span>

<span class="sd">    Raises</span>
<span class="sd">       ClientError: If there&#39;s a DynamoDB client error/function during account retrieval.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">data</span> <span class="o">=</span> <span class="n">request</span><span class="o">.</span><span class="n">json</span>
    <span class="k">try</span><span class="p">:</span>
        <span class="c1"># Check if all required parameters are present</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">user_id</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">jsonify</span><span class="p">({</span><span class="s2">&quot;error&quot;</span><span class="p">:</span> <span class="s2">&quot;User ID is missing&quot;</span><span class="p">,</span> <span class="s2">&quot;status&quot;</span><span class="p">:</span> <span class="kc">False</span><span class="p">}),</span> <span class="mi">400</span>

        <span class="c1"># Call search_orders function</span>
        <span class="n">res</span> <span class="o">=</span> <span class="n">dynamodb_users</span><span class="o">.</span><span class="n">search_orders</span><span class="p">(</span><span class="n">user_id</span><span class="p">)</span>

        <span class="c1"># Return the response</span>
        <span class="k">return</span> <span class="n">jsonify</span><span class="p">({</span><span class="s2">&quot;status&quot;</span><span class="p">:</span> <span class="kc">True</span><span class="p">,</span> <span class="s2">&quot;value&quot;</span><span class="p">:</span> <span class="n">res</span><span class="p">}),</span> <span class="mi">200</span>
    <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
        <span class="c1"># If an exception occurs, return an error response</span>
        <span class="k">return</span> <span class="n">jsonify</span><span class="p">({</span><span class="s2">&quot;error&quot;</span><span class="p">:</span> <span class="nb">str</span><span class="p">(</span><span class="n">e</span><span class="p">),</span> <span class="s2">&quot;status&quot;</span><span class="p">:</span> <span class="kc">False</span><span class="p">}),</span> <span class="mi">500</span></div>




<div class="viewcode-block" id="add_order_req">
<a class="viewcode-back" href="../routes.html#routes.add_order_req">[docs]</a>
<span class="nd">@route_blueprint</span><span class="o">.</span><span class="n">route</span><span class="p">(</span><span class="s2">&quot;/orders&quot;</span><span class="p">,</span> <span class="n">methods</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;POST&quot;</span><span class="p">])</span>
<span class="k">def</span> <span class="nf">add_order_req</span><span class="p">():</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Adds a new order to users order table. This function requires the user id, product id, and product quantity in the body.</span>

<span class="sd">    Returns:</span>
<span class="sd">        json: JSON response containing the order details. Returns status true if the operation is successful, and false otherwise.</span>

<span class="sd">    Raises:</span>
<span class="sd">        ClientError: If there&#39;s a DynamoDB client error/function during account retrieval.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">data</span> <span class="o">=</span> <span class="n">request</span><span class="o">.</span><span class="n">json</span>

    <span class="c1"># Check if all required parameters are present</span>
    <span class="n">required_params</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;user_id&quot;</span><span class="p">,</span> <span class="s2">&quot;product_id&quot;</span><span class="p">,</span> <span class="s2">&quot;quantity&quot;</span><span class="p">]</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="nb">all</span><span class="p">(</span><span class="n">param</span> <span class="ow">in</span> <span class="n">data</span> <span class="k">for</span> <span class="n">param</span> <span class="ow">in</span> <span class="n">required_params</span><span class="p">):</span>
        <span class="k">return</span> <span class="n">jsonify</span><span class="p">({</span><span class="s2">&quot;status&quot;</span><span class="p">:</span> <span class="kc">False</span><span class="p">,</span> <span class="s2">&quot;value&quot;</span><span class="p">:</span> <span class="s2">&quot;Missing required parameters&quot;</span><span class="p">}),</span> <span class="mi">400</span>

    <span class="k">if</span> <span class="n">data</span><span class="p">[</span><span class="s2">&quot;quantity&quot;</span><span class="p">]</span> <span class="o">&lt;=</span> <span class="mi">0</span><span class="p">:</span>
        <span class="k">return</span> <span class="p">(</span>
            <span class="n">jsonify</span><span class="p">(</span>
                <span class="p">{</span><span class="s2">&quot;status&quot;</span><span class="p">:</span> <span class="kc">False</span><span class="p">,</span> <span class="s2">&quot;message&quot;</span><span class="p">:</span> <span class="s2">&quot;order quantity should be at least 1&quot;</span><span class="p">}</span>
            <span class="p">),</span>
            <span class="mi">400</span><span class="p">,</span>
        <span class="p">)</span>

    <span class="c1"># If all checks pass, proceed to add the order</span>
    <span class="k">try</span><span class="p">:</span>
        <span class="n">res</span> <span class="o">=</span> <span class="n">dynamodb_users</span><span class="o">.</span><span class="n">add_item</span><span class="p">(</span>
            <span class="n">data</span><span class="p">[</span><span class="s2">&quot;user_id&quot;</span><span class="p">],</span> <span class="n">data</span><span class="p">[</span><span class="s2">&quot;product_id&quot;</span><span class="p">],</span> <span class="n">data</span><span class="p">[</span><span class="s2">&quot;quantity&quot;</span><span class="p">]</span>
        <span class="p">)</span>
        <span class="k">return</span> <span class="n">jsonify</span><span class="p">({</span><span class="s2">&quot;status&quot;</span><span class="p">:</span> <span class="kc">True</span><span class="p">,</span> <span class="s2">&quot;value&quot;</span><span class="p">:</span> <span class="n">res</span><span class="p">}),</span> <span class="mi">200</span>
    <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">jsonify</span><span class="p">({</span><span class="s2">&quot;status&quot;</span><span class="p">:</span> <span class="kc">False</span><span class="p">,</span> <span class="s2">&quot;value&quot;</span><span class="p">:</span> <span class="nb">str</span><span class="p">(</span><span class="n">e</span><span class="p">)}),</span> <span class="mi">500</span></div>



<div class="viewcode-block" id="search_po_orders">
<a class="viewcode-back" href="../routes.html#routes.search_po_orders">[docs]</a>
<span class="nd">@route_blueprint</span><span class="o">.</span><span class="n">route</span><span class="p">(</span><span class="s2">&quot;/orders/product/search/&lt;product_owner_id&gt;&quot;</span><span class="p">,</span> <span class="n">methods</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;GET&quot;</span><span class="p">])</span>
<span class="k">def</span> <span class="nf">search_po_orders</span><span class="p">(</span><span class="n">product_owner_id</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Searches for PO orders with the specified Product Owner name/ID</span>

<span class="sd">    Args:</span>
<span class="sd">        product_owner_id (string): Unique product owner name/id</span>

<span class="sd">    Returns:</span>
<span class="sd">        json : Array of JSON response containing po orders details of orders that match the search criteria</span>

<span class="sd">    Raises</span>
<span class="sd">       ClientError: If there&#39;s a DynamoDB client error/function during account retrieval.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">try</span><span class="p">:</span>
        <span class="c1"># Check if the product_owner_id parameter is provided</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">product_owner_id</span><span class="p">:</span>
            <span class="k">return</span> <span class="p">(</span>
                <span class="n">jsonify</span><span class="p">({</span><span class="s2">&quot;error&quot;</span><span class="p">:</span> <span class="s2">&quot;Product owner ID is missing&quot;</span><span class="p">,</span> <span class="s2">&quot;status&quot;</span><span class="p">:</span> <span class="kc">False</span><span class="p">}),</span>
                <span class="mi">400</span><span class="p">,</span>
            <span class="p">)</span>

        <span class="c1"># Call the search_orders_by_po function</span>
        <span class="n">res</span> <span class="o">=</span> <span class="n">dynamodb_po</span><span class="o">.</span><span class="n">search_orders_by_po</span><span class="p">(</span><span class="n">product_owner_id</span><span class="p">)</span>

        <span class="c1"># Return the response</span>
        <span class="k">return</span> <span class="n">jsonify</span><span class="p">({</span><span class="s2">&quot;status&quot;</span><span class="p">:</span> <span class="kc">True</span><span class="p">,</span> <span class="s2">&quot;value&quot;</span><span class="p">:</span> <span class="n">res</span><span class="p">}),</span> <span class="mi">200</span>
    <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
        <span class="c1"># If an exception occurs, return an error response</span>
        <span class="k">return</span> <span class="n">jsonify</span><span class="p">({</span><span class="s2">&quot;error&quot;</span><span class="p">:</span> <span class="nb">str</span><span class="p">(</span><span class="n">e</span><span class="p">),</span> <span class="s2">&quot;status&quot;</span><span class="p">:</span> <span class="kc">False</span><span class="p">}),</span> <span class="mi">500</span></div>



<div class="viewcode-block" id="search_po_orders_status">
<a class="viewcode-back" href="../routes.html#routes.search_po_orders_status">[docs]</a>
<span class="nd">@route_blueprint</span><span class="o">.</span><span class="n">route</span><span class="p">(</span><span class="s2">&quot;/orders/product/search/status/&lt;order_status&gt;&quot;</span><span class="p">,</span> <span class="n">methods</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;GET&quot;</span><span class="p">])</span>
<span class="k">def</span> <span class="nf">search_po_orders_status</span><span class="p">(</span><span class="n">order_status</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Searches for PO orders with the specified order status</span>

<span class="sd">    Args:</span>
<span class="sd">        order_status (string): Product Owner order status</span>

<span class="sd">    Returns:</span>
<span class="sd">        json : Array of JSON response containing po orders details of orders that match the search criteria</span>

<span class="sd">    Raises</span>
<span class="sd">       ClientError: If there&#39;s a DynamoDB client error/function during account retrieval.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">try</span><span class="p">:</span>
        <span class="c1"># Check if the order_status parameter is provided</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">order_status</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">jsonify</span><span class="p">({</span><span class="s2">&quot;error&quot;</span><span class="p">:</span> <span class="s2">&quot;Order Status is missing&quot;</span><span class="p">,</span> <span class="s2">&quot;status&quot;</span><span class="p">:</span> <span class="kc">False</span><span class="p">}),</span> <span class="mi">400</span>

        <span class="k">if</span> <span class="n">order_status</span> <span class="ow">not</span> <span class="ow">in</span> <span class="p">[</span><span class="s2">&quot;paid&quot;</span><span class="p">,</span> <span class="s2">&quot;unpaid&quot;</span><span class="p">]:</span>
            <span class="k">return</span> <span class="p">(</span>
                <span class="n">jsonify</span><span class="p">(</span>
                    <span class="p">{</span>
                        <span class="s2">&quot;error&quot;</span><span class="p">:</span> <span class="s2">&quot;Order Status has to be one of paid, unpaid&quot;</span><span class="p">,</span>
                        <span class="s2">&quot;status&quot;</span><span class="p">:</span> <span class="kc">False</span><span class="p">,</span>
                    <span class="p">}</span>
                <span class="p">),</span>
                <span class="mi">400</span><span class="p">,</span>
            <span class="p">)</span>
        <span class="c1"># Call the search_orders_by_status function</span>
        <span class="n">res</span> <span class="o">=</span> <span class="n">dynamodb_po</span><span class="o">.</span><span class="n">search_po_orders_by_status</span><span class="p">(</span><span class="n">order_status</span><span class="p">)</span>

        <span class="c1"># Return the response</span>
        <span class="k">return</span> <span class="n">jsonify</span><span class="p">({</span><span class="s2">&quot;status&quot;</span><span class="p">:</span> <span class="kc">True</span><span class="p">,</span> <span class="s2">&quot;value&quot;</span><span class="p">:</span> <span class="n">res</span><span class="p">}),</span> <span class="mi">200</span>
    <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
        <span class="c1"># If an exception occurs, return an error response</span>
        <span class="k">return</span> <span class="n">jsonify</span><span class="p">({</span><span class="s2">&quot;error&quot;</span><span class="p">:</span> <span class="nb">str</span><span class="p">(</span><span class="n">e</span><span class="p">),</span> <span class="s2">&quot;status&quot;</span><span class="p">:</span> <span class="kc">False</span><span class="p">}),</span> <span class="mi">500</span></div>



<div class="viewcode-block" id="search_orders_status_and_user_id">
<a class="viewcode-back" href="../routes.html#routes.search_orders_status_and_user_id">[docs]</a>
<span class="nd">@route_blueprint</span><span class="o">.</span><span class="n">route</span><span class="p">(</span>
    <span class="s2">&quot;/orders/search/user/&lt;user_id&gt;/status/&lt;order_status&gt;&quot;</span><span class="p">,</span> <span class="n">methods</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;GET&quot;</span><span class="p">]</span>
<span class="p">)</span>
<span class="k">def</span> <span class="nf">search_orders_status_and_user_id</span><span class="p">(</span><span class="n">user_id</span><span class="p">,</span> <span class="n">order_status</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Searches for user orders with the specified user ID and order status</span>

<span class="sd">    Args:</span>
<span class="sd">        user_id (string): Unique user ID</span>
<span class="sd">        order_status (string): User order status</span>

<span class="sd">    Returns:</span>
<span class="sd">        json : Array of JSON response containing orders details of orders that match the search criteria</span>

<span class="sd">    Raises</span>
<span class="sd">       ClientError: If there&#39;s a DynamoDB client error/function during account retrieval.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">try</span><span class="p">:</span>
        <span class="c1"># Check if both user_id and order_status parameters are provided</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">user_id</span> <span class="ow">or</span> <span class="ow">not</span> <span class="n">order_status</span><span class="p">:</span>
            <span class="k">return</span> <span class="p">(</span>
                <span class="n">jsonify</span><span class="p">(</span>
                    <span class="p">{</span><span class="s2">&quot;error&quot;</span><span class="p">:</span> <span class="s2">&quot;User ID or Order status is missing&quot;</span><span class="p">,</span> <span class="s2">&quot;status&quot;</span><span class="p">:</span> <span class="kc">False</span><span class="p">}</span>
                <span class="p">),</span>
                <span class="mi">400</span><span class="p">,</span>
            <span class="p">)</span>

        <span class="k">if</span> <span class="n">order_status</span> <span class="ow">not</span> <span class="ow">in</span> <span class="p">[</span><span class="s2">&quot;paid&quot;</span><span class="p">,</span> <span class="s2">&quot;unpaid&quot;</span><span class="p">]:</span>
            <span class="k">return</span> <span class="p">(</span>
                <span class="n">jsonify</span><span class="p">(</span>
                    <span class="p">{</span>
                        <span class="s2">&quot;error&quot;</span><span class="p">:</span> <span class="s2">&quot;Order Status has to be one of paid, unpaid&quot;</span><span class="p">,</span>
                        <span class="s2">&quot;status&quot;</span><span class="p">:</span> <span class="kc">False</span><span class="p">,</span>
                    <span class="p">}</span>
                <span class="p">),</span>
                <span class="mi">400</span><span class="p">,</span>
            <span class="p">)</span>

        <span class="c1"># Call the search_orders_by_status function</span>
        <span class="n">res</span> <span class="o">=</span> <span class="n">dynamodb_users</span><span class="o">.</span><span class="n">search_orders_by_userid_and_status</span><span class="p">(</span><span class="n">user_id</span><span class="p">,</span> <span class="n">order_status</span><span class="p">)</span>

        <span class="c1"># Return the response</span>
        <span class="k">return</span> <span class="n">jsonify</span><span class="p">({</span><span class="s2">&quot;status&quot;</span><span class="p">:</span> <span class="kc">True</span><span class="p">,</span> <span class="s2">&quot;value&quot;</span><span class="p">:</span> <span class="n">res</span><span class="p">}),</span> <span class="mi">200</span>
    <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
        <span class="c1"># If an exception occurs, return an error response</span>
        <span class="k">return</span> <span class="n">jsonify</span><span class="p">({</span><span class="s2">&quot;error&quot;</span><span class="p">:</span> <span class="nb">str</span><span class="p">(</span><span class="n">e</span><span class="p">),</span> <span class="s2">&quot;status&quot;</span><span class="p">:</span> <span class="kc">False</span><span class="p">}),</span> <span class="mi">500</span></div>



<div class="viewcode-block" id="search_orders_status_and_po_id">
<a class="viewcode-back" href="../routes.html#routes.search_orders_status_and_po_id">[docs]</a>
<span class="nd">@route_blueprint</span><span class="o">.</span><span class="n">route</span><span class="p">(</span>
    <span class="s2">&quot;/orders/search/po/&lt;po_id&gt;/status/&lt;order_status&gt;&quot;</span><span class="p">,</span> <span class="n">methods</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;GET&quot;</span><span class="p">]</span>
<span class="p">)</span>
<span class="k">def</span> <span class="nf">search_orders_status_and_po_id</span><span class="p">(</span><span class="n">po_id</span><span class="p">,</span> <span class="n">order_status</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Searches for PO orders with the specified Product Owner and order status</span>

<span class="sd">    Args:</span>
<span class="sd">        po_id (string): Product Owner ID</span>
<span class="sd">        order_status (string): Product Owner order status</span>

<span class="sd">    Returns:</span>
<span class="sd">        json : Array of JSON response containing orders details of orders that match the search criteria</span>

<span class="sd">    Raises</span>
<span class="sd">       ClientError: If there&#39;s a DynamoDB client error/function during account retrieval.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">try</span><span class="p">:</span>
        <span class="c1"># Check if both user_id and order_status parameters are provided</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">po_id</span> <span class="ow">or</span> <span class="ow">not</span> <span class="n">order_status</span><span class="p">:</span>
            <span class="k">return</span> <span class="p">(</span>
                <span class="n">jsonify</span><span class="p">({</span><span class="s2">&quot;error&quot;</span><span class="p">:</span> <span class="s2">&quot;PO ID or Order status is missing&quot;</span><span class="p">,</span> <span class="s2">&quot;status&quot;</span><span class="p">:</span> <span class="kc">False</span><span class="p">}),</span>
                <span class="mi">400</span><span class="p">,</span>
            <span class="p">)</span>

        <span class="k">if</span> <span class="n">order_status</span> <span class="ow">not</span> <span class="ow">in</span> <span class="p">[</span><span class="s2">&quot;paid&quot;</span><span class="p">,</span> <span class="s2">&quot;unpaid&quot;</span><span class="p">]:</span>
            <span class="k">return</span> <span class="p">(</span>
                <span class="n">jsonify</span><span class="p">(</span>
                    <span class="p">{</span>
                        <span class="s2">&quot;error&quot;</span><span class="p">:</span> <span class="s2">&quot;Order Status has to be one of paid, unpaid&quot;</span><span class="p">,</span>
                        <span class="s2">&quot;status&quot;</span><span class="p">:</span> <span class="kc">False</span><span class="p">,</span>
                    <span class="p">}</span>
                <span class="p">),</span>
                <span class="mi">400</span><span class="p">,</span>
            <span class="p">)</span>

        <span class="c1"># Call the search_orders_by_status function</span>
        <span class="n">res</span> <span class="o">=</span> <span class="n">dynamodb_po</span><span class="o">.</span><span class="n">search_orders_by_po_id_and_status</span><span class="p">(</span><span class="n">po_id</span><span class="p">,</span> <span class="n">order_status</span><span class="p">)</span>

        <span class="c1"># Return the response</span>
        <span class="k">return</span> <span class="n">jsonify</span><span class="p">({</span><span class="s2">&quot;status&quot;</span><span class="p">:</span> <span class="kc">True</span><span class="p">,</span> <span class="s2">&quot;value&quot;</span><span class="p">:</span> <span class="n">res</span><span class="p">}),</span> <span class="mi">200</span>
    <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
        <span class="c1"># If an exception occurs, return an error response</span>
        <span class="k">return</span> <span class="n">jsonify</span><span class="p">({</span><span class="s2">&quot;error&quot;</span><span class="p">:</span> <span class="nb">str</span><span class="p">(</span><span class="n">e</span><span class="p">),</span> <span class="s2">&quot;status&quot;</span><span class="p">:</span> <span class="kc">False</span><span class="p">}),</span> <span class="mi">500</span></div>



<div class="viewcode-block" id="set_po_orders_paid">
<a class="viewcode-back" href="../routes.html#routes.set_po_orders_paid">[docs]</a>
<span class="nd">@route_blueprint</span><span class="o">.</span><span class="n">route</span><span class="p">(</span>
    <span class="s2">&quot;/orders/product/&lt;order_id&gt;/&lt;product_owner_id&gt;/paid&quot;</span><span class="p">,</span> <span class="n">methods</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;GET&quot;</span><span class="p">]</span>
<span class="p">)</span>
<span class="k">def</span> <span class="nf">set_po_orders_paid</span><span class="p">(</span><span class="n">order_id</span><span class="p">,</span> <span class="n">product_owner_id</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Sets the status of PO order which has a unique order_id, product_owner_id combination, from unpaid to paid</span>

<span class="sd">    Args:</span>
<span class="sd">        order_id (string): Unique order ID</span>
<span class="sd">        product_owner_id (string): Unique product owner name/id</span>

<span class="sd">    Returns:</span>
<span class="sd">        json : JSON response containing the order details, with status true if successful operation, and false otherwise.</span>

<span class="sd">    Raises</span>
<span class="sd">       ClientError: If there&#39;s a DynamoDB client error/function during account retrieval.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">try</span><span class="p">:</span>
        <span class="c1"># Check if both order_id and product_owner_id parameters are provided</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">order_id</span> <span class="ow">or</span> <span class="ow">not</span> <span class="n">product_owner_id</span><span class="p">:</span>
            <span class="k">return</span> <span class="p">(</span>
                <span class="n">jsonify</span><span class="p">(</span>
                    <span class="p">{</span>
                        <span class="s2">&quot;error&quot;</span><span class="p">:</span> <span class="s2">&quot;Order ID or Product owner ID is missing&quot;</span><span class="p">,</span>
                        <span class="s2">&quot;status&quot;</span><span class="p">:</span> <span class="kc">False</span><span class="p">,</span>
                    <span class="p">}</span>
                <span class="p">),</span>
                <span class="mi">400</span><span class="p">,</span>
            <span class="p">)</span>

        <span class="c1"># Call the update_po_status function</span>
        <span class="n">res</span> <span class="o">=</span> <span class="n">dynamodb_po</span><span class="o">.</span><span class="n">update_po_status</span><span class="p">(</span><span class="n">product_owner_id</span><span class="p">,</span> <span class="n">order_id</span><span class="p">,</span> <span class="s2">&quot;paid&quot;</span><span class="p">)</span>

        <span class="c1"># Return the response</span>
        <span class="k">return</span> <span class="n">jsonify</span><span class="p">({</span><span class="s2">&quot;status&quot;</span><span class="p">:</span> <span class="kc">True</span><span class="p">,</span> <span class="s2">&quot;value&quot;</span><span class="p">:</span> <span class="n">res</span><span class="p">}),</span> <span class="mi">200</span>
    <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
        <span class="c1"># If an exception occurs, return an error response</span>
        <span class="k">return</span> <span class="n">jsonify</span><span class="p">({</span><span class="s2">&quot;error&quot;</span><span class="p">:</span> <span class="nb">str</span><span class="p">(</span><span class="n">e</span><span class="p">),</span> <span class="s2">&quot;status&quot;</span><span class="p">:</span> <span class="kc">False</span><span class="p">}),</span> <span class="mi">500</span></div>



<div class="viewcode-block" id="set_user_order_status_paid">
<a class="viewcode-back" href="../routes.html#routes.set_user_order_status_paid">[docs]</a>
<span class="nd">@route_blueprint</span><span class="o">.</span><span class="n">route</span><span class="p">(</span><span class="s2">&quot;/orders/&lt;order_id&gt;/status/paid&quot;</span><span class="p">,</span> <span class="n">methods</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;GET&quot;</span><span class="p">])</span>
<span class="k">def</span> <span class="nf">set_user_order_status_paid</span><span class="p">(</span><span class="n">order_id</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Searches for user orders with the passed order id</span>

<span class="sd">    Args:</span>
<span class="sd">        order_id (string): Unique order ID</span>

<span class="sd">    Returns:</span>
<span class="sd">        json : JSON response containing the order details, with status true if successful operation, and false otherwise.</span>

<span class="sd">    Raises</span>
<span class="sd">       ClientError: If there&#39;s a DynamoDB client error/function during account retrieval.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">try</span><span class="p">:</span>
        <span class="n">res</span> <span class="o">=</span> <span class="n">dynamodb_users</span><span class="o">.</span><span class="n">update_status</span><span class="p">(</span><span class="n">order_id</span><span class="p">,</span> <span class="s2">&quot;paid&quot;</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">jsonify</span><span class="p">({</span><span class="s2">&quot;status&quot;</span><span class="p">:</span> <span class="kc">True</span><span class="p">,</span> <span class="s2">&quot;value&quot;</span><span class="p">:</span> <span class="n">res</span><span class="p">}),</span> <span class="mi">200</span>
    <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
        <span class="c1"># Return an appropriate error response</span>
        <span class="k">return</span> <span class="n">jsonify</span><span class="p">({</span><span class="s2">&quot;status&quot;</span><span class="p">:</span> <span class="kc">False</span><span class="p">,</span> <span class="s2">&quot;error&quot;</span><span class="p">:</span> <span class="s2">&quot;Internal Server Error&quot;</span><span class="p">}),</span> <span class="mi">500</span></div>



<div class="viewcode-block" id="search_user_order_by_status">
<a class="viewcode-back" href="../routes.html#routes.search_user_order_by_status">[docs]</a>
<span class="nd">@route_blueprint</span><span class="o">.</span><span class="n">route</span><span class="p">(</span><span class="s2">&quot;/orders/search/status/&lt;status&gt;&quot;</span><span class="p">,</span> <span class="n">methods</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;GET&quot;</span><span class="p">])</span>
<span class="k">def</span> <span class="nf">search_user_order_by_status</span><span class="p">(</span><span class="n">status</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Searches for user orders with the passed order status</span>

<span class="sd">    Args:</span>
<span class="sd">        status (string): User order status</span>

<span class="sd">    Returns:</span>
<span class="sd">        json : Array of JSON response containing orders details of orders that match the search criteria</span>

<span class="sd">    Raises</span>
<span class="sd">       ClientError: If there&#39;s a DynamoDB client error/function during account retrieval.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">try</span><span class="p">:</span>
        <span class="n">res</span> <span class="o">=</span> <span class="n">dynamodb_users</span><span class="o">.</span><span class="n">search_orders_by_status</span><span class="p">(</span><span class="n">status</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">jsonify</span><span class="p">({</span><span class="s2">&quot;status&quot;</span><span class="p">:</span> <span class="kc">True</span><span class="p">,</span> <span class="s2">&quot;value&quot;</span><span class="p">:</span> <span class="n">res</span><span class="p">}),</span> <span class="mi">200</span>
    <span class="k">except</span> <span class="ne">ValueError</span> <span class="k">as</span> <span class="n">ve</span><span class="p">:</span>
        <span class="c1"># Handle specific error if needed</span>
        <span class="k">return</span> <span class="n">jsonify</span><span class="p">({</span><span class="s2">&quot;status&quot;</span><span class="p">:</span> <span class="kc">False</span><span class="p">,</span> <span class="s2">&quot;error&quot;</span><span class="p">:</span> <span class="nb">str</span><span class="p">(</span><span class="n">ve</span><span class="p">)}),</span> <span class="mi">400</span>
    <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
        <span class="c1"># Return an appropriate error response</span>
        <span class="k">return</span> <span class="n">jsonify</span><span class="p">({</span><span class="s2">&quot;status&quot;</span><span class="p">:</span> <span class="kc">False</span><span class="p">,</span> <span class="s2">&quot;error&quot;</span><span class="p">:</span> <span class="s2">&quot;Internal Server Error&quot;</span><span class="p">}),</span> <span class="mi">500</span></div>



<span class="c1"># ----------------------------------------------------------------------------#</span>
<span class="c1"># Invoice APIs</span>
<span class="c1"># ----------------------------------------------------------------------------#</span>
<span class="c1"># Create a invoice pdf out of the order details for one order</span>


<div class="viewcode-block" id="route_create_invoice">
<a class="viewcode-back" href="../routes.html#routes.route_create_invoice">[docs]</a>
<span class="nd">@route_blueprint</span><span class="o">.</span><span class="n">route</span><span class="p">(</span><span class="s2">&quot;/invoice/&lt;order_id&gt;&quot;</span><span class="p">,</span> <span class="n">methods</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;POST&quot;</span><span class="p">])</span>
<span class="k">def</span> <span class="nf">route_create_invoice</span><span class="p">(</span><span class="n">order_id</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Create a invoice pdf out of the order details for one order</span>

<span class="sd">    Args:</span>
<span class="sd">        order_id (string): Unique order ID</span>

<span class="sd">    Returns:</span>
<span class="sd">        boolean: staus true if invoice creation was successful, and false otherwise</span>

<span class="sd">    Raises</span>
<span class="sd">       ClientError: If there&#39;s a DynamoDB client error/function during account retrieval.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="n">order_id</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">jsonify</span><span class="p">({</span><span class="s2">&quot;error&quot;</span><span class="p">:</span> <span class="s2">&quot;ID is required!&quot;</span><span class="p">}),</span> <span class="mi">400</span>
    <span class="k">try</span><span class="p">:</span>
        <span class="n">message</span><span class="p">,</span> <span class="n">status</span> <span class="o">=</span> <span class="n">invoice</span><span class="o">.</span><span class="n">create_pdf</span><span class="p">(</span><span class="n">order_id</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">status</span> <span class="o">==</span> <span class="kc">True</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">jsonify</span><span class="p">({</span><span class="s2">&quot;value&quot;</span><span class="p">:</span> <span class="n">message</span><span class="p">,</span> <span class="s2">&quot;status&quot;</span><span class="p">:</span> <span class="n">status</span><span class="p">}),</span> <span class="mi">200</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">jsonify</span><span class="p">({</span><span class="s2">&quot;message&quot;</span><span class="p">:</span> <span class="n">message</span><span class="p">,</span> <span class="s2">&quot;status&quot;</span><span class="p">:</span> <span class="n">status</span><span class="p">}),</span> <span class="mi">200</span>
    <span class="k">except</span> <span class="n">ClientError</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Error adding review:&quot;</span><span class="p">,</span> <span class="n">e</span><span class="p">)</span></div>



<span class="c1">## Download the invoice for a specific order</span>


<div class="viewcode-block" id="route_get_invoice">
<a class="viewcode-back" href="../routes.html#routes.route_get_invoice">[docs]</a>
<span class="nd">@route_blueprint</span><span class="o">.</span><span class="n">route</span><span class="p">(</span><span class="s2">&quot;/invoice/&lt;order_id&gt;&quot;</span><span class="p">,</span> <span class="n">methods</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;GET&quot;</span><span class="p">])</span>
<span class="k">def</span> <span class="nf">route_get_invoice</span><span class="p">(</span><span class="n">order_id</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Download the invoice for a specific order</span>

<span class="sd">    Args:</span>
<span class="sd">        order_id (string): Unique order ID</span>

<span class="sd">    Returns:</span>
<span class="sd">         : invoice contents</span>

<span class="sd">    Raises</span>
<span class="sd">       ClientError: If there&#39;s a DynamoDB client error/function during account retrieval.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="n">order_id</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">jsonify</span><span class="p">({</span><span class="s2">&quot;error&quot;</span><span class="p">:</span> <span class="s2">&quot;ID is required!&quot;</span><span class="p">}),</span> <span class="mi">400</span>
    <span class="k">try</span><span class="p">:</span>
        <span class="n">item</span><span class="p">,</span> <span class="n">status</span> <span class="o">=</span> <span class="n">invoice</span><span class="o">.</span><span class="n">get_invoice</span><span class="p">(</span><span class="n">order_id</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">jsonify</span><span class="p">({</span><span class="s2">&quot;value&quot;</span><span class="p">:</span> <span class="n">item</span><span class="p">,</span> <span class="s2">&quot;status&quot;</span><span class="p">:</span> <span class="n">status</span><span class="p">}),</span> <span class="mi">200</span>
    <span class="k">except</span> <span class="n">ClientError</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Error adding review:&quot;</span><span class="p">,</span> <span class="n">e</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">jsonify</span><span class="p">({</span><span class="s2">&quot;error&quot;</span><span class="p">:</span> <span class="s2">&quot;Failed to get review&quot;</span><span class="p">}),</span> <span class="mi">500</span></div>



<span class="c1"># ----------------------------------------------------------------------------#</span>
<span class="c1"># Testing APIs</span>
<span class="c1"># ----------------------------------------------------------------------------#</span>


<div class="viewcode-block" id="get_all_po_orders">
<a class="viewcode-back" href="../routes.html#routes.get_all_po_orders">[docs]</a>
<span class="nd">@route_blueprint</span><span class="o">.</span><span class="n">route</span><span class="p">(</span><span class="s2">&quot;/orders/po&quot;</span><span class="p">,</span> <span class="n">methods</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;GET&quot;</span><span class="p">])</span>
<span class="k">def</span> <span class="nf">get_all_po_orders</span><span class="p">():</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;_summary_</span>

<span class="sd">    Returns:</span>
<span class="sd">        json : Array of JSON response containing all po orders details in the PO order table.</span>

<span class="sd">    Raises</span>
<span class="sd">       ClientError: If there&#39;s a DynamoDB client error/function during account retrieval.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">try</span><span class="p">:</span>
        <span class="c1"># Call the get_all_po_orders function</span>
        <span class="n">res</span> <span class="o">=</span> <span class="n">dynamodb_po</span><span class="o">.</span><span class="n">get_all_po_orders</span><span class="p">()</span>

        <span class="c1"># Return the response</span>
        <span class="k">return</span> <span class="n">jsonify</span><span class="p">({</span><span class="s2">&quot;status&quot;</span><span class="p">:</span> <span class="kc">True</span><span class="p">,</span> <span class="s2">&quot;value&quot;</span><span class="p">:</span> <span class="n">res</span><span class="p">}),</span> <span class="mi">200</span>
    <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
        <span class="c1"># If an exception occurs, return an error response</span>
        <span class="k">return</span> <span class="n">jsonify</span><span class="p">({</span><span class="s2">&quot;error&quot;</span><span class="p">:</span> <span class="nb">str</span><span class="p">(</span><span class="n">e</span><span class="p">),</span> <span class="s2">&quot;status&quot;</span><span class="p">:</span> <span class="kc">False</span><span class="p">}),</span> <span class="mi">500</span></div>



<div class="viewcode-block" id="search_po_orders_orderid">
<a class="viewcode-back" href="../routes.html#routes.search_po_orders_orderid">[docs]</a>
<span class="nd">@route_blueprint</span><span class="o">.</span><span class="n">route</span><span class="p">(</span><span class="s2">&quot;/orders/po/test/search/order_id/&lt;order_id&gt;&quot;</span><span class="p">,</span> <span class="n">methods</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;GET&quot;</span><span class="p">])</span>
<span class="k">def</span> <span class="nf">search_po_orders_orderid</span><span class="p">(</span><span class="n">order_id</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;_summary_</span>

<span class="sd">    Args:</span>
<span class="sd">        order_id (string): Unique order ID</span>

<span class="sd">    Returns:</span>
<span class="sd">        json : Array of JSON response containing PO orders details of orders that match the search criteria</span>

<span class="sd">    Raises</span>
<span class="sd">       ClientError: If there&#39;s a DynamoDB client error/function during account retrieval.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">try</span><span class="p">:</span>
        <span class="c1"># Check if the order_id parameter is provided</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">order_id</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">jsonify</span><span class="p">({</span><span class="s2">&quot;error&quot;</span><span class="p">:</span> <span class="s2">&quot;Order ID is missing&quot;</span><span class="p">,</span> <span class="s2">&quot;status&quot;</span><span class="p">:</span> <span class="kc">False</span><span class="p">}),</span> <span class="mi">400</span>

        <span class="c1"># Call the search_orders_by_orderid function</span>
        <span class="n">res</span> <span class="o">=</span> <span class="n">dynamodb_po</span><span class="o">.</span><span class="n">search_orders_by_orderid</span><span class="p">(</span><span class="n">order_id</span><span class="p">)</span>

        <span class="c1"># Return the response</span>
        <span class="k">return</span> <span class="n">jsonify</span><span class="p">({</span><span class="s2">&quot;status&quot;</span><span class="p">:</span> <span class="kc">True</span><span class="p">,</span> <span class="s2">&quot;value&quot;</span><span class="p">:</span> <span class="n">res</span><span class="p">}),</span> <span class="mi">200</span>
    <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
        <span class="c1"># If an exception occurs, return an error response</span>
        <span class="k">return</span> <span class="n">jsonify</span><span class="p">({</span><span class="s2">&quot;error&quot;</span><span class="p">:</span> <span class="nb">str</span><span class="p">(</span><span class="n">e</span><span class="p">),</span> <span class="s2">&quot;status&quot;</span><span class="p">:</span> <span class="kc">False</span><span class="p">}),</span> <span class="mi">500</span></div>



<div class="viewcode-block" id="test_search_po_orders">
<a class="viewcode-back" href="../routes.html#routes.test_search_po_orders">[docs]</a>
<span class="nd">@route_blueprint</span><span class="o">.</span><span class="n">route</span><span class="p">(</span>
    <span class="s2">&quot;/orders/test/po/search/&lt;order_id&gt;/&lt;product_owner_id&gt;&quot;</span><span class="p">,</span> <span class="n">methods</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;GET&quot;</span><span class="p">]</span>
<span class="p">)</span>
<span class="k">def</span> <span class="nf">test_search_po_orders</span><span class="p">(</span><span class="n">order_id</span><span class="p">,</span> <span class="n">product_owner_id</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;_summary_</span>

<span class="sd">    Args:</span>
<span class="sd">        order_id (string): Unique order ID</span>
<span class="sd">        product_owner_id (string): Unique product owner name/id</span>

<span class="sd">    Returns:</span>
<span class="sd">        json : Array of JSON response containing PO orders details of orders that match the search criteria</span>

<span class="sd">    Raises</span>
<span class="sd">       ClientError: If there&#39;s a DynamoDB client error/function during account retrieval.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">try</span><span class="p">:</span>
        <span class="c1"># Check if both order_id and product_owner_id parameters are provided</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">order_id</span> <span class="ow">or</span> <span class="ow">not</span> <span class="n">product_owner_id</span><span class="p">:</span>
            <span class="k">return</span> <span class="p">(</span>
                <span class="n">jsonify</span><span class="p">(</span>
                    <span class="p">{</span>
                        <span class="s2">&quot;error&quot;</span><span class="p">:</span> <span class="s2">&quot;Order ID or Product owner ID is missing&quot;</span><span class="p">,</span>
                        <span class="s2">&quot;status&quot;</span><span class="p">:</span> <span class="kc">False</span><span class="p">,</span>
                    <span class="p">}</span>
                <span class="p">),</span>
                <span class="mi">400</span><span class="p">,</span>
            <span class="p">)</span>

        <span class="c1"># Call the search_po_orders function</span>
        <span class="n">res</span> <span class="o">=</span> <span class="n">dynamodb_po</span><span class="o">.</span><span class="n">search_po_orders</span><span class="p">(</span>
            <span class="n">product_owner</span><span class="o">=</span><span class="n">product_owner_id</span><span class="p">,</span> <span class="n">order_id</span><span class="o">=</span><span class="n">order_id</span>
        <span class="p">)</span>

        <span class="c1"># Return the response</span>
        <span class="k">return</span> <span class="n">jsonify</span><span class="p">({</span><span class="s2">&quot;status&quot;</span><span class="p">:</span> <span class="kc">True</span><span class="p">,</span> <span class="s2">&quot;value&quot;</span><span class="p">:</span> <span class="n">res</span><span class="p">}),</span> <span class="mi">200</span>
    <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
        <span class="c1"># If an exception occurs, return an error response</span>
        <span class="k">return</span> <span class="n">jsonify</span><span class="p">({</span><span class="s2">&quot;error&quot;</span><span class="p">:</span> <span class="nb">str</span><span class="p">(</span><span class="n">e</span><span class="p">),</span> <span class="s2">&quot;status&quot;</span><span class="p">:</span> <span class="kc">False</span><span class="p">}),</span> <span class="mi">500</span></div>



<span class="c1"># ----------------------------------------------------------------------------#</span>
<span class="c1"># Error Handling.</span>
<span class="c1"># ----------------------------------------------------------------------------#</span>


<span class="nd">@route_blueprint</span><span class="o">.</span><span class="n">app_errorhandler</span><span class="p">(</span><span class="mi">400</span><span class="p">)</span>
<span class="k">def</span> <span class="nf">unprocessable</span><span class="p">(</span><span class="n">error</span><span class="p">):</span>
    <span class="k">return</span> <span class="n">jsonify</span><span class="p">({</span><span class="s2">&quot;success&quot;</span><span class="p">:</span> <span class="kc">False</span><span class="p">,</span> <span class="s2">&quot;value&quot;</span><span class="p">:</span> <span class="s2">&quot;bad request&quot;</span><span class="p">}),</span> <span class="mi">400</span>


<div class="viewcode-block" id="not_found">
<a class="viewcode-back" href="../routes.html#routes.not_found">[docs]</a>
<span class="nd">@route_blueprint</span><span class="o">.</span><span class="n">app_errorhandler</span><span class="p">(</span><span class="mi">404</span><span class="p">)</span>
<span class="k">def</span> <span class="nf">not_found</span><span class="p">(</span><span class="n">error</span><span class="p">):</span>
    <span class="k">return</span> <span class="n">jsonify</span><span class="p">({</span><span class="s2">&quot;success&quot;</span><span class="p">:</span> <span class="kc">False</span><span class="p">,</span> <span class="s2">&quot;value&quot;</span><span class="p">:</span> <span class="s2">&quot;resource not found&quot;</span><span class="p">}),</span> <span class="mi">404</span></div>



<div class="viewcode-block" id="method_not_allowed">
<a class="viewcode-back" href="../routes.html#routes.method_not_allowed">[docs]</a>
<span class="nd">@route_blueprint</span><span class="o">.</span><span class="n">app_errorhandler</span><span class="p">(</span><span class="mi">405</span><span class="p">)</span>
<span class="k">def</span> <span class="nf">method_not_allowed</span><span class="p">(</span><span class="n">error</span><span class="p">):</span>
    <span class="k">return</span> <span class="n">jsonify</span><span class="p">({</span><span class="s2">&quot;success&quot;</span><span class="p">:</span> <span class="kc">False</span><span class="p">,</span> <span class="s2">&quot;value&quot;</span><span class="p">:</span> <span class="s2">&quot;method not allowed&quot;</span><span class="p">},</span> <span class="mi">405</span><span class="p">)</span></div>



<div class="viewcode-block" id="unprocessable">
<a class="viewcode-back" href="../routes.html#routes.unprocessable">[docs]</a>
<span class="nd">@route_blueprint</span><span class="o">.</span><span class="n">app_errorhandler</span><span class="p">(</span><span class="mi">422</span><span class="p">)</span>
<span class="k">def</span> <span class="nf">unprocessable</span><span class="p">(</span><span class="n">error</span><span class="p">):</span>
    <span class="k">return</span> <span class="n">jsonify</span><span class="p">({</span><span class="s2">&quot;success&quot;</span><span class="p">:</span> <span class="kc">False</span><span class="p">,</span> <span class="s2">&quot;value&quot;</span><span class="p">:</span> <span class="s2">&quot;unprocessable&quot;</span><span class="p">}),</span> <span class="mi">422</span></div>



<div class="viewcode-block" id="internal_server_error">
<a class="viewcode-back" href="../routes.html#routes.internal_server_error">[docs]</a>
<span class="nd">@route_blueprint</span><span class="o">.</span><span class="n">app_errorhandler</span><span class="p">(</span><span class="mi">500</span><span class="p">)</span>
<span class="k">def</span> <span class="nf">internal_server_error</span><span class="p">(</span><span class="n">error</span><span class="p">):</span>
    <span class="k">return</span> <span class="n">jsonify</span><span class="p">({</span><span class="s2">&quot;success&quot;</span><span class="p">:</span> <span class="kc">False</span><span class="p">,</span> <span class="s2">&quot;value&quot;</span><span class="p">:</span> <span class="s2">&quot;Internal Server Error&quot;</span><span class="p">},</span> <span class="mi">500</span><span class="p">)</span></div>

</pre></div>

          </div>
          
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
<h1 class="logo"><a href="../index.html">Orders Service</a></h1>








<h3>Navigation</h3>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../dynamodb_po.html">DaynamoDB Product Owner Orders</a></li>
<li class="toctree-l1"><a class="reference internal" href="../dynamodb_users.html">DanamoDB Users Orders</a></li>
<li class="toctree-l1"><a class="reference internal" href="../initialise_dynamo.html">Initialise DynamoDB</a></li>
<li class="toctree-l1"><a class="reference internal" href="../invoice.html">Invoice</a></li>
<li class="toctree-l1"><a class="reference internal" href="../routes.html">Routes</a></li>
<li class="toctree-l1"><a class="reference internal" href="../utils.html">Utils</a></li>
</ul>

<div class="relations">
<h3>Related Topics</h3>
<ul>
  <li><a href="../index.html">Documentation overview</a><ul>
  <li><a href="index.html">Module code</a><ul>
  </ul></li>
  </ul></li>
</ul>
</div>
<search id="searchbox" style="display: none" role="search">
  <h3 id="searchlabel">Quick search</h3>
    <div class="searchformwrapper">
    <form class="search" action="../search.html" method="get">
      <input type="text" name="q" aria-labelledby="searchlabel" autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false"/>
      <input type="submit" value="Go" />
    </form>
    </div>
</search>
<script>document.getElementById('searchbox').style.display = "block"</script>








        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="footer">
      &#169;2024, Heba.
      
      |
      Powered by <a href="https://www.sphinx-doc.org/">Sphinx 7.3.7</a>
      &amp; <a href="https://alabaster.readthedocs.io">Alabaster 0.7.16</a>
      
    </div>

    

    
  </body>
</html>